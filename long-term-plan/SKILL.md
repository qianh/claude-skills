---
name: long-term-plan
description: |
  帮助用户创建和管理长期项目计划。通过结构化的多轮对话引导用户明确目标、拆解里程碑、
  分解可执行任务并安排日程。适用于内容创作计划、学习计划、投资跟踪、信息分析等场景。
  当用户提到「长期计划」「项目规划」「任务拆解」「日程安排」时触发。
---

# 长期计划助手

## 触发场景

当用户需要：
- 创建一个跨天/跨周的长期项目计划
- 将一个大目标拆解为可执行的任务
- 安排任务到具体日期并设置优先级
- 制定内容创作、学习、投资跟踪等领域的系统性计划

## 工作流程

### 阶段 0：环境检查与项目转化（最先执行）

> **重要：这是最优先的步骤，在做任何其他事情之前必须先执行。**

检查当前对话是否已在项目上下文中：

**情况 A — 已在项目中：**
如果系统提示中包含「项目上下文」信息，且你能直接调用 `create_tasks`、`update_plan_document` 等工具 → 跳过此阶段，直接进入阶段 1。

**情况 B — 不在项目中（普通对话）：**
如果你的可用工具中有 `convert_to_project`，说明当前是普通对话，需要先转化为项目：
1. 直接调用 `convert_to_project` 工具，传入：
   - `title`：根据对话内容生成简明的项目标题
   - `plan_document`（可选）：将对话中已梳理的目标和计划整理为 Markdown
2. 转化成功后，`create_tasks`、`update_plan_document` 等项目工具**立即可用**，无需等待下一轮对话
3. 继续执行阶段 1

**注意：不要搜索或尝试其他工具来完成转化。`convert_to_project` 是唯一正确的方式。**

### 阶段 1：明确目标

引导用户回答以下问题：
- 你想达成什么目标？
- 时间范围是多久？（一周/一个月/一个季度）
- 你的当前水平或起点是什么？
- 有哪些已知的约束条件？（时间、资源、技能）

产出：清晰的项目标题和核心目标描述。

### 阶段 2：拆解里程碑

根据目标和时间范围，建议 3-5 个关键里程碑：
- 每个里程碑有明确的可衡量产出
- 里程碑之间有合理的时间间隔
- 考虑依赖关系和学习曲线

使用 `update_plan_document` 工具创建计划文档，包含：
- 核心目标
- 里程碑列表
- 时间线概览

### 阶段 3：分解任务

将每个里程碑拆解为具体任务，使用 `create_tasks` 工具批量创建：
- 每个任务标题清晰、可执行
- 设置合理的 `scheduled_date`
- 区分 `auto`（AI 可自动完成）和 `manual`（需用户参与）
- 设置 `estimated_minutes` 预估耗时
- 通过 `depends_on_titles` 建立任务依赖
- 按重要性设置 `priority`（0=普通, 1=重要, 2=紧急）

### 阶段 4：确认与启动

向用户展示完整计划总览：
- 任务总数、自动/手动比例
- 时间分布
- 关键依赖路径

确认后，自动任务将按日程开始执行。

## 任务分类指南

### 适合 auto（自动执行）的任务
- 信息调研和竞品分析
- 文档起草和内容生成
- 数据收集和整理
- 模板和框架搭建
- 报告生成

### 适合 manual（手动执行）的任务
- 需要用户决策的环节
- 涉及外部平台操作（发布、注册等）
- 需要主观判断的审阅和修改
- 与第三方沟通协调

## 注意事项

- 任务描述要足够详细，让 AI 执行时有明确方向
- 合理设置依赖关系，避免循环依赖
- 预估耗时要考虑 AI 的实际执行能力
- 首次规划后可随时通过对话调整计划