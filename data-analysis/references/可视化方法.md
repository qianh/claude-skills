# 数据可视化方法及使用场景

## 类别比较类
核心目的：比较不同分类之间的大小、多少。

### A. 柱状图 (Bar Chart) / 条形图 (Column Chart)
**使用场景：**
- 柱状图 (垂直)：分类较少（<10个），或带有时间序列含义的对比（如：各季度营收）。

- 条形图 (水平)：分类很多，或者分类名称很长的时候（如：各省份GDP排名，水平放置方便阅读文字）。

**注意事项：**
- 纵轴必须从0开始：否则会夸大数据的差异（截断坐标轴是数据造假的常用手段）。

- 间距适中：柱子之间的间隙宽度最好是柱子宽度的 1/2 左右。

- 颜色克制：除非为了区分特定类别，否则不要给每个柱子都涂上不同颜色。

### B. 雷达图 (Radar Chart)
**使用场景：**
- 多维数据对比：专门用于评估对象的综合能力（如：王者荣耀里的英雄属性——攻击、防御、法术、难度；或者员工绩效评估）。

**注意事项：**
- 维度限制：维度最好控制在 5-8 个，太少没意义，太多会变成一个“圆”。

- 度量统一：各维度的刻度标准必须一致或归一化，否则图形会畸形。


## 趋势演变类
核心目的：看数据随时间的变化。

### A. 折线图 (Line Chart)
**使用场景：**
- 连续时间数据：如股票走势、网站日活（DAU）、气温变化。

- 多组趋势对比：如对比今年和去年的月销售额曲线。

**注意事项：**
- 线条数量：同张图里的线条不要超过 4-5条，否则会变成“面条图”，难以分辨。

- 纵轴比例：如果波动很小，可以适当调整纵轴起点（不像柱状图必须从0开始），但要标注清楚，以免误导。

### B. 面积图 (Area Chart)
**使用场景：**
- 不仅看趋势，还想强调累积的数量感。

- 堆叠面积图：既看总趋势，又看各部分组成的变化（如：公司总营收及各业务线的贡献变化）。

**注意事项：**
- 透明度：如果不是堆叠而是重叠，必须设置透明度，否则后面的数据会被挡住。


## 数据分布类
核心目的：看数据是怎么撒在坐标轴上的，以此判断规律或异常。

### A. 直方图 (Histogram)
**使用场景：**
- 连续变量的频率分布：如“用户年龄分布”、“考试成绩分布”、“产品寿命分布”。

- 判断数据是否符合正态分布。

**注意事项：**
- 分箱 大小：柱子的宽度（组距）非常关键，分得太细会有很多噪点，分得太粗会掩盖细节。

- 区分柱状图：直方图柱子之间是没有间隙的（因为数据是连续的），而柱状图有间隙。

### B. 箱线图 (Box Plot)
**使用场景：**
- 统计分析专用：当你需要展示数据的中位数、四分位数、极值时。

- 异常值检测：非常适合一眼看出哪些数据是离群点（Outliers）。例如：对比不同部门的薪资结构（不仅看平均薪资，还看贫富差距）。

**注意事项：**
- 受众门槛：非技术背景的使用者可能看不懂，需要解释什么是“上下四分位”和“须”。

- 样本量：如果样本量太小（如少于10个），不如直接把点画出来（用抖动散点图），不要强行画箱线图。


## 占比构成类
核心目的：看部分占整体的比例。

### A. 饼图 (Pie Chart) / 环形图 (Donut Chart)
**使用场景：**
- 简单的占比展示，强调“某一部分很大”或“很小”。

**注意事项 (这是最容易被滥用的图表)：**
- 切片数量：千万不要超过 5-6 块。如果类别太多，请把小的合并为“其他”，或者改用条形图。

- 人眼缺陷：人眼对面积和角度的敏感度远低于长度（柱状图）。如果各部分比例接近（如 26% vs 24%），饼图很难看出来，请用柱状图。

- 总和：所有切片加起来必须等于 100%。

### B. 堆叠柱状图 (Stacked Bar Chart)
**使用场景：**
- 既要对比总量，又要看内部结构。例如：不仅要比A公司和B公司的总营收，还要比他们各自的游戏、广告、电商收入占比。

**注意事项：**
- 基准线问题：除了最底部的那个分类，中间和上部的分类因为起点不齐，很难进行横向对比。


## 关系与相关性
**核心目的：**看两个或多个变量之间有没有关系。

### A. 散点图 (Scatter Plot)
**使用场景：**
- 探索相关性：看 X 变大时，Y 是变大还是变小？例如：广告投入 vs 销售额；身高 vs 体重。

**注意事项：**
- 重叠问题：如果数据点太多聚在一起，可以使用透明度 (Alpha) 或改用六边形分箱图 (Hexbin)。

- 趋势线：通常可以添加一条回归线来辅助判断相关性强弱。

### B. 热力图 (Heatmap)
**使用场景：**
- 相关性矩阵：展示多个变量两两之间的相关系数。

- 时空分布：如网页点击热力图、商场人流热力图。

- 交叉表可视化：如某个月每天（横轴）不同时段（纵轴）的订单量。

**注意事项：**
- 配色方案：
单向数据（0到100）：用渐变色（白 -> 蓝）。
双向数据（-1到1）：用发散色（红 -> 白 -> 蓝），中间色必须是中性的。


## 交互式仪表盘
### 1. 适用场景

当用户请求包含以下特征时，必须触发此指令逻辑：
* **汇报演示**：需要生成脱离代码环境也能展示的、外观精美的报表（Portable Reports）。
* **多维数据展示**：静态图片无法有效展示超过3个维度的数据（如：时间+地区+销量+利润率）。
* **大数据量概览**：数据点过多，静态图会导致重叠，需要通过交互缩放来查看局部。

### 2. 推荐工具栈

为了确保生成的 HTML 文件具有**独立性**且易于分发，我们按优先级推荐以下 Python 库：

* **Priority 1: Plotly (Python)**
    * **理由**：工业级标准，生成的 HTML 文件自带 JS 引擎，支持丰富的交互（Hover, Zoom, Pan）。
    * **核心库**：`plotly.express` (快速绘图), `plotly.graph_objects` (高度定制)。
    * **输出方式**：`fig.write_html("output.html", include_plotlyjs="cdn")`。

* **Priority 2: PyEcharts**
    * **理由**：基于百度 ECharts，图表美观度极高，适合生成“大屏”风格的仪表盘。
    * **注意**：需确保生成的 HTML 引用了正确的 CDN 链接。

* **Priority 3: Bokeh**
    * **理由**：适合处理大规模数据集的交互（通过 WebGL 加速），支持复杂的联动视图（Linked Brushing）。

### 3. 执行逻辑与注意事项

智能体在生成代码时，必须强制遵守以下规范：

#### A. 数据处理
* **聚合降维**：Web 浏览器渲染能力有限。若原始数据超过 10,000 行，**严禁**直接将所有散点抛给前端。必须先在 Python 端进行 `groupby`、`resample` 或数据采样。
* **敏感脱敏**：生成的 HTML 文件源码中会包含数据（JSON 格式）。**必须**在生成前对敏感字段（如手机号、身份证）进行脱敏，防止数据泄露。

#### B. 布局设计
* **单文件原则**：生成的仪表盘必须是**单个 HTML 文件**。CSS 和 JS 尽量内联或使用稳定 CDN，避免依赖本地其他文件。
* **响应式设计**：尽量使用百分比宽度，确保在不同分辨率下不崩坏。
